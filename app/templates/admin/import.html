{% extends "base.html" %}
{% block content %}
<h2 class="mb-4 text-primary"><i class="fa-solid fa-file-import"></i> Excel-Import von Gästen & Tieren</h2>

<p class="text-muted mb-4">
  Hier kannst Du eine vorbereitete Excel-Datei hochladen, um Gäste und ihre Tiere in das System zu importieren.
  Die Datei sollte der aktuellen Vorlage entsprechen.
</p>

<form method="post" enctype="multipart/form-data" action="{{ url_for('admin.import_data') }}" class="needs-validation" novalidate>
  <div class="mb-3">
    <label for="file" class="form-label">Excel-Datei (.xlsx):</label>
    <input class="form-control" type="file" name="file" id="file" accept=".xlsx" required>
    <div class="invalid-feedback">Bitte wähle eine Excel-Datei aus.</div>
  </div>

  <div class="d-flex justify-content-between">
    <a href="{{ url_for('static', filename='ImportVorlage_PfotenRegister.xlsx') }}" class="btn btn-outline-secondary">
      <i class="fa-solid fa-download"></i> Vorlage herunterladen
    </a>
    <button type="submit" class="btn btn-primary">
      <i class="fa-solid fa-upload"></i> Hochladen & Vorschau anzeigen
    </button>
  </div>
</form>

<script>
  // Bootstrap Form Validation
  (function () {
    'use strict';
    const forms = document.querySelectorAll('.needs-validation');
    Array.from(forms).forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  })();
</script>
{% endblock %}